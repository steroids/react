# Архитектура проекта

Steroids предлагает единую архитектуру для ваших проектов. Следуя данным принципам и правилам, вы сможете в короткие
сроки создавать сложные приложения, которые будет легко поддерживать в будущем.

## Структура приложения

Общая структура приложения с одной страницей и макетом выглядит следующим образом:

```
.storybook - настройки сторибука
node_modules - npm зависимости
public - директория для билда
src
    actions - redux actions
    reducers - redux reducers
    modals - модальные окна
    routes - роуты (страницы) приложения
        IndexPage - папка реакт компонента
            views - компоненты, используемые только в IndexPage
                MyBox.ts
                MyBox.scss
            IndexPage.ts - реакт компонент
            IndexPage.scss - БЭМ стили компонента
            index.ts - подгрузка компонента как директории
    shared - общие компоненты
        Layout
            Layout.ts
            Layout.scss
            index.ts
    ui - стилизованные и кастомные UI компоненты
        form
            Button
                ButtonView.tsx
                ButtonView.scss
            CustomField
                CustomField.ts
                CustomFieldView.tsx
                CustomFieldView.scss
    style
        index.scss - главный файл стилей
        variables.scss - scss переменные
    Application.tsx - основной компонент приложения
    index.tsx
.eslintrc - правила стилизации
index.d.ts - общие типы тайпскрипта
package.json - описание зависимостей
tsconfig.json - настройки тайпскрипта
webpack.js - настройки вебпак билда
yarn.lock - фиксированные версии зависимостей
```

В директорию `public` можно добавлять статику (картинки, шрифты) для использования их в приложении по абсолютному пути.
В эту же директорию будут сохраняться минифицированные бандлы приложения, генерируемые вебпаком.

Папка `src` - исходники проекта, они не публикуются при выгрузке проекта на продакшен.

В корне исходников лежат два файла - `index.tsx` и `Application.tsx`. Их разделение и названия лучше оставлять именно
такими, т.к. при использовании `SSR` nodejs сервер-приложение будет рендерить именно `Application.tsx`. Файл `index.tsx`
в данном случае используется только для рендера через `react-dom` в браузере.

В директориях `actions` и `reducers` содержатся соответственно экшены и редьюсеры для `redux` хранилища. Их не обязательно
создавать, в библиотеке уже есть множество редьюеров, которыми может пользоваться приложение. Если папка `reducers` не
создана, то вебпак возьмет редьюсеры из библиотеки (`node_modules/@steroidsjs/reducers`).

Все роуты описываются в файле `routes/index.ts`. Подробнее об их возможностях и формате записи можно прочитать
в разделе [Роутинг](routes.md).

React компоненты приложения распределяются по папкам `modals`, `routes`, `shared` и `ui`. В других папках React
компонентов быть не может. При большом количестве компонентов рекомендуется дополнительно логически группировать их по подпапкам.


## React компоненты

Реакт компоненты всегда состоят из двух файлов - `tsx` и `scss`. Даже если сейчас нет необходимости задавать компоненту стили,
но компонент содержит jsx код, то все равно стоит создавать `*.scss` файл стилей и подключать его через `import` в `*.tsx` файле.

Каждый компонент, как правило, выделяется в отдельную папку, которой объявляется index.ts. Задача этого файла - подгрузить
и выдать компонент:

```ts
import IndexPage from './IndexPage';
export default IndexPage;
```

Делается это для того, чтобы при дальнейшем импорте компонента был более красивый и короткий путь - `routes/IndexPage`.
Без этого "хака" нужно было бы писать `routes/IndexPage/IndexPage`.


## Вложенные компоненты

Если компонент большой (или, например, это страница *Page), то его разбивают на несколько частей и используют в `jsx` коде.
Такие компоненты нужно располагать в подпапке `views` (см. `routes/IndexPage/views/*` в структуре), если эти вложенные
компоненты используются только в данном компоненте. Либо выносить их в `shared`, если это общие компоненты и они
могут использоваться в нескольких местах.


## Стили (scss)

Базовые (общие для всех компонентов) стили приложения располагаются в папке `style`. Эти стили (файл `index.scss`)
подключаются в самом начале инициализации приложения (в файле `Application.tsx`).

В этом месте происходит объявление используемых шрифтов, базовые стили для основных тегов, миксины и переменные. Также
в этом файле могут подключаться библиотечные `css` файлы или дефолтные стили самих стероидов - `@import '@steroidsjs/bootstrap/index.scss';`

Файл с переменными выносится всегда в отдельный файл, доступный по адресу `style/variables.scss`. Он содержит только SCSS
переменные и подгружается в каждом файле стилей реакт компонентов (пример: `IndexPage.scss`, `ButtonView.scss`)
